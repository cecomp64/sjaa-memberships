<%= turbo_frame_tag 'people' do %>
  <%= pagy_bootstrap_nav(@pagy).html_safe %>
  <div class="table-responsive">
    <table class="table table-hover table-striped table-sm">
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>City</th>
        <th>State</th>
        <th>Status</th>
        <th>Ephemeris</th>
        <th>Interests</th>
        <th>Donations</th>
      </tr>
      <tbody class="table-group-divider">
        <% @people.each do |person| %>
          <tr>
            <td><%=link_to "#{person.first_name} #{person.last_name}", person_path(person.id), data: {turbo: false} %></td>
            <td><%=person.contacts.map(&:email).join(', ')%></td>
            <td><%=person.contacts.map(&:phone).join(', ')%></td>
            <td><%=person.contacts.map{|con| con.city&.name}.join(', ')%></td>
            <td><%=person.contacts.map{|con| con.state&.short_name}.join(', ')%></td>
            <td><%=person.status&.name%></td>
            <td><%=person.memberships.last&.ephemeris ? 'PRINT' : ''%></td>
            <td><%=person.interests.map(&:name).join(', ')%></td>
            <td><%=person.donations.map{|d| dollar_format(d.value)}.join(', ')%></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <%= pagy_bootstrap_nav(@pagy).html_safe %>
<% end %>